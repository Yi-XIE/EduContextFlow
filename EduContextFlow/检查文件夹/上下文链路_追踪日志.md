# ğŸ” ä¸Šä¸‹æ–‡é“¾è·¯è¿½è¸ªæ—¥å¿—ï¼ˆContext Traceï¼‰

æœ¬ç³»ç»Ÿåœ¨ `app.py` ä¸­æ–°å¢äº†é“¾è·¯è¿½è¸ªæ—¥å¿—ï¼Œç”¨æ¥å®šä½ï¼š
- ä¸Šä¸‹æ–‡æ˜¯å¦æ³¨å…¥
- å“ªä¸ªä¸Šä¸‹æ–‡æ–‡ä»¶ç¼ºå¤±/è¯»å–å¤±è´¥
- æœ€ç»ˆæ‹¼æ¥çš„è¾“å…¥æ˜¯å¦ä¸ºç©º
- è°ƒåº¦å™¨æ˜¯å¦æ­£ç¡®åˆ†æ”¯

---

## âœ… æ—¥å¿—æ–‡ä»¶ä½ç½®

```
/Users/brick/Desktop/EduContextFlow/outputs/context_trace.log
```

---

## âœ… æ—¥å¿—è§¦å‘ç‚¹ï¼ˆä¸ä»£ç ä¸€ä¸€å¯¹åº”ï¼‰

### 1. Dispatcher å†³ç­–è®°å½•
å½“ `dispatch()` è¿”å›ç»“æœæ—¶å†™å…¥ï¼š

```
[dispatch] action=call_skill skill=script_from_transcript reason=...
```

**å«ä¹‰**ï¼šè°ƒåº¦å™¨å·²ç»é€‰æ‹©äº†å…·ä½“ Skillã€‚

---

### 2. ä¸Šä¸‹æ–‡è¯»å–è®°å½•ï¼ˆæ¯ä¸ªä¾èµ–ä¸€ä¸ªè®°å½•ï¼‰
å½“ `_prepare_skill_input()` è¯»å–æˆåŠŸæ—¶ï¼š

```
[prepare_input] skill=script_from_transcript ctx=transcript ref=outputs/transcript.md bytes=1234
```

**å«ä¹‰**ï¼šæ­¤ Skill éœ€è¦çš„ `transcript` å·²æˆåŠŸä»æ–‡ä»¶è¯»å–ã€‚

---

### 3. ç¼ºå¤±ä¸Šä¸‹æ–‡è®°å½•ï¼ˆæ–­å±‚å®šä½ï¼‰
å½“ä¾èµ–ç¼ºå¤±æˆ–æ–‡ä»¶ä¸å­˜åœ¨æ—¶ï¼š

```
[prepare_input] skill=script_from_transcript missing_context=transcript
```

**å«ä¹‰**ï¼šè¯¥ Skill çš„å¿…éœ€ä¸Šä¸‹æ–‡æ— æ³•è¯»å–ï¼Œç³»ç»Ÿä¼šç›´æ¥è¿”å›é”™è¯¯ï¼Œä¸å†æ‰§è¡Œã€‚

---

### 4. è¾“å…¥æ‹¼æ¥é•¿åº¦è®°å½•
å½“æœ€ç»ˆè¾“å…¥æ‹¼æ¥å®Œæˆæ—¶ï¼š

```
[prepare_input] skill=script_from_transcript final_input_bytes=4123
```

**å«ä¹‰**ï¼šæœ€ç»ˆä¼ å…¥ Executor çš„ input_text é•¿åº¦ä¸º 4123 å­—èŠ‚ã€‚

---

## âœ… å¦‚ä½•æ£€æŸ¥

### æŸ¥çœ‹æœ€è¿‘ 20 è¡Œï¼š
```bash
tail -n 20 outputs/context_trace.log
```

### åªè¿‡æ»¤æŸä¸ª Skillï¼š
```bash
grep "script_from_transcript" outputs/context_trace.log
```

---

## âœ… å…¸å‹æ­£å¸¸é“¾è·¯ç¤ºä¾‹

```
[dispatch] action=call_skill skill=script_from_transcript reason=ä¾èµ–å·²æ»¡è¶³
[prepare_input] skill=script_from_transcript ctx=transcript ref=outputs/transcript.md bytes=1210
[prepare_input] skill=script_from_transcript final_input_bytes=1450
```

**è§£é‡Š**ï¼š
- è°ƒåº¦å™¨è°ƒç”¨äº†è„šæœ¬ç”Ÿæˆ
- é€å­—ç¨¿æˆåŠŸè¯»å–
- è¾“å…¥æ‹¼æ¥æˆåŠŸï¼Œä¼ å…¥æ‰§è¡Œå™¨

---

## ğŸš¨ å…¸å‹æ–­å±‚ç¤ºä¾‹

```
[dispatch] action=call_skill skill=script_from_transcript reason=...
[prepare_input] skill=script_from_transcript missing_context=transcript
```

**è§£é‡Š**ï¼š
- è°ƒåº¦å™¨å†³å®šè°ƒç”¨è„šæœ¬ç”Ÿæˆ
- ä½† transcript æ–‡ä»¶ç¼ºå¤±/ä¸ºç©º
- ç³»ç»Ÿä¸­æ­¢æ‰§è¡Œå¹¶è¿”å›é”™è¯¯

---

**è¯·æŒ‰æ­¤æ—¥å¿—æ’æŸ¥ä¸Šä¸‹æ–‡æ–­å±‚é—®é¢˜ã€‚**
